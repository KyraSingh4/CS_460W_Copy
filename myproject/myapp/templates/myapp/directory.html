<!DOCTYPE html>
<html>
{% load static %}
  <link rel="stylesheet" href="{% static 'style.css' %}" />

<div class="navbar">
  <h1 class="app-name">A.C.E.D.</h1>
  <nav class="nav">
    <a href="../scheduler/" class="nav-elem">Court Scheduler</a>
    <a href="../billing/" class="nav-elem">Billing</a>
    <a href="../directory/" class="nav-elem">Member Directory</a>
    <a href="../account/" class="nav-elem">
        {% if request.session.member_id == 1 or request.session.member_id == 2 %}
            Admin Dashboard
        {% else %}
        My Account
        {% endif %}
    </a>
    <a href="../logout/" class="nav-elem">Log Out</a>
  </nav>
</div>

  {% if request.session.member_id != none %}
<center>

  <div class="dir-page">
      {% if Error %}
  <div class="error-msg">
    <div class="title-container">
      <h2 class="error-title">Error</h2>
    </div>
    <div class="desc-container">
      <span class="error-desc">{{Error}}</span>
    </div>
  </div>
  {% endif %}

  {% if Success %}
  <div class="succ-msg">
    <div class="title-container-succ">
      <h2 class="succ-title">Success</h2>
    </div>
    <div class="desc-container">
      <span class="succ-desc">{{Success}}</span>
    </div>
  </div>
  {% endif %}
  <h2 id="dir-title">Search Directory</h2>
<form class="dropdown" method="post">
    {% csrf_token %}
    {% if request.session.member_id != 1 and request.session.member_id != 2 %}
        <label class="drop-btn" for="search">Select Attribute:</label>
        <select name = "attribute" id="attribute">
            <option class="attribute" value="firstname">First Name</option>
            <option class="attribute" value="lastname">Last Name</option>
            <option class="attribute" value="email">Email</option>
            <option class="attribute" value="phonenum">Phone Number</option>
        </select>
            <input name = "value" class="searchbar" placeholder="Select attribute, then search value" required>
            <input name ="submittype" id="search-btn" type="submit" value="Search">
    {% else %}
        <label class="drop-btn" for="search">Select Attribute:</label>
        <select name = "attribute" id="attribute">
            <option class="attribute" value="member_id">Member ID</option>
            <option class="attribute" value="firstname">First Name</option>
            <option class="attribute" value="lastname">Last Name</option>
            <option class="attribute" value="email">Email</option>
            <option class="attribute" value="phonenum">Phone Number</option>
            <option class="attribute" value="guestpass">Guest Passes</option>
            <option class="attribute" value="optIN">Opt-In Status</option>
            <option class="attribute" value="active">Active Status</option>
        </select>
            <input name="value" class="searchbar" placeholder="Select attribute, then search value" required>
            <input name="submittype" type="submit" value="Search">
    {% endif %}
    </form>
<br> <br>
<form method="post">
    {% csrf_token %}
    <input name="submittype" type="submit" value="View the Full Directory">
</form>
{% if request.session.member_id == 1 %}
<h2>Register a New Member</h2>
<form method="post">
    {% csrf_token %}
    <input name="fname" class="searchbar" placeholder="First Name" required>
    <input name="lname" class="searchbar" placeholder="Last Name" required>
    <input name="email" class="searchbar" placeholder="Email" required>
    <input name="phonenum" class="searchbar" placeholder="Phone Number" required>
    <input name="optin" class="searchbar" placeholder="Opt-In Status (True or False)" required>
    <input name="password" class="searchbar" placeholder="Password" required>
    <input name="submittype" type="submit" value="Create Member" required>
</form>
<h2>Update a Member</h2>
      <form method="post">
          {% csrf_token %}
          <input name="member_id" class="searchbar" placeholder="Member ID" required>
          <select name="attribute">
            <option class="attribute" value="firstname">First Name</option>
            <option class="attribute" value="lastname">Last Name</option>
            <option class="attribute" value="email">Email</option>
            <option class="attribute" value="phonenum">Phone Number</option>
            <option class="attribute" value="optIN">Opt-In Status</option>
            <option class="attribute" value="password">Password</option>
          </select>
          <input name="value" class="searchbar" placeholder="Value to Change" required>
          <input name="submittype" type="submit" value="Update Member">
      </form>
<h2>Deactivate a Member</h2>
    <form method="post">
        {% csrf_token %}
        <input name="memid" class="searchbar" placeholder="Member ID" required>
        <input name="submittype" type="submit" value="Deactivate Member">
    </form>
{% endif %}


{% if results %}
    <h2>Search Results</h2>
    <table border="1" class="table-style" id="dir-view">
        {% if request.session.member_id != 1 and request.session.member_id != 2 %}
            <tr>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Phone Number</th>
            </tr>
            {% for result in results %}
                <tr>
                    <td class="dir-elem">{{ result.0 }}</td>
                    <td class="dir-elem">{{ result.1 }}</td>
                    <td class="dir-elem">{{ result.2 }}</td>
                    <td class="dir-elem">{{ result.3 }}</td>
                </tr>
            {% endfor %}
        {% else %}
            <tr>
                <th>Member ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Phone Number</th>
                <th>Guest Passes</th>
                <th>Opt In Status</th>
                <th>Active Status</th>
            </tr>
            {% for result in results %}
                <tr>
                    <td class="dir-elem">{{ result.0 }}</td>
                    <td class="dir-elem">{{ result.1 }}</td>
                    <td class="dir-elem">{{ result.2 }}</td>
                    <td class="dir-elem">{{ result.3 }}</td>
                    <td class="dir-elem">{{ result.4 }}</td>
                    <td class="dir-elem">{{ result.5 }}</td>
                    <td class="dir-elem">{{ result.6 }}</td>
                    <td class="dir-elem">{{ result.7 }}</td>
                </tr>
            {% endfor %}
        {% endif %}
    </table>
{% endif %}
</div>
</center>
{% else %}
    <div class="error-msg">
    <div class="title-container">
      <h2 class="error-title">Please Log In</h2>
    </div>
    <div class="desc-container">
      <a href="../login/" class="nav-elem">Go to Log In</a>
    </div>
  </div>
{% endif %}
</html>
